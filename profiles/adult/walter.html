<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Walter's Profile - Momentum</title>
  <link rel="stylesheet" href="../../assets/css/styles.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <style>
    .hero-section {
      background-color: #f2f2f2; /* Light gray container */
      border-radius: 10px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    
    .welcome-message {
      color: #000000; /* Black text */
      font-size: 1.5rem;
      margin-bottom: 10px;
    }
    
    .motivation-quote {
      color: #555555; /* Dark gray text */
      font-style: italic;
    }
    
    .next-workout {
      background-color: #e0e0e0; /* Slightly darker gray for inner elements */
      padding: 15px;
      border-radius: 8px;
      margin-top: 15px;
    }
    
    .next-workout h3 {
      color: #000000;
      margin-top: 0;
    }
    
    .next-workout p {
      color: #333333;
    }
    
    .start-btn {
      background-color: #4CAF50; /* Green button */
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
      margin-top: 10px;
    }
    
    .goal-tracker {
      background-color: #f2f2f2; /* Light gray container */
      border-radius: 10px;
      padding: 20px;
      margin: 20px 0;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    
    .goal-tracker h2 {
      color: #000000;
      margin-top: 0;
    }
    
    .goal-tracker p {
      color: #333333;
    }
    
    .progress-bar {
      height: 10px;
      background-color: #e0e0e0;
      border-radius: 5px;
      margin: 15px 0;
      overflow: hidden;
    }
    
    .progress-fill {
      height: 100%;
      background-color: #4CAF50;
      width: 65%;
    }
    
    .completion-time {
      font-size: 0.8rem;
      color: #bbb;
    }
    
    .action-buttons {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }
    
    .action-btn {
      background-color: #555;
      color: white;
      border: none;
      padding: 8px 12px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 0.9rem;
    }

    /* Light theme with gray containers */
    body {
      background-color: white;
    }

    .exercise-list {
      background-color: #f2f2f2;
      border-radius: 10px;
      padding: 15px;
      margin-bottom: 20px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .exercise-item {
      background-color: #e0e0e0;
      padding: 10px 15px;
      border-radius: 8px;
      margin-bottom: 10px;
      color: #000000;
    }

    .exercise-item h4 {
      margin: 0 0 5px 0;
      color: #000000;
    }

    .exercise-item p {
      margin: 0;
      font-size: 0.9rem;
      color: #555555;
    }

    /* Membership Card Styles */
    .card-container {
      perspective: 1000px;
      height: 200px;
      margin: 20px 0;
    }

    .membership-card {
      position: relative;
      width: 100%;
      height: 100%;
      transform-style: preserve-3d;
      transition: transform 0.8s;
      cursor: pointer;
      border-radius: 12px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }

    .membership-card.flipped {
      transform: rotateY(180deg);
    }

    .card-side {
      position: absolute;
      width: 100%;
      height: 100%;
      backface-visibility: hidden;
      border-radius: 12px;
      display: flex;
      flex-direction: column;
    }

    .card-front {
      background: linear-gradient(135deg, #4CAF50 0%, #2E7D32 100%);
      color: white;
      padding: 20px;
    }

    .card-back {
      background-color: white;
      transform: rotateY(180deg);
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      align-items: center;
      padding: 20px;
    }

    .card-logo {
      display: flex;
      align-items: center;
      font-size: 1.2rem;
      font-weight: bold;
      margin-bottom: 20px;
    }

    .card-logo i {
      margin-right: 10px;
      font-size: 1.5rem;
    }

    .card-details {
      flex-grow: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }

    .member-name {
      font-size: 1.5rem;
      font-weight: bold;
      margin-bottom: 10px;
    }

    .member-id, .member-since {
      font-size: 0.9rem;
      margin-bottom: 5px;
    }

    .card-instructions {
      font-size: 0.8rem;
      opacity: 0.8;
      text-align: center;
      margin-top: 25px;
    }

    .barcode-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      width: 100%;
      padding: 15px;
    }

    #barcode-placeholder {
      width: 100%;
      text-align: center;
      margin-bottom: 15px;
    }

    #barcode-image {
      max-width: 100%;
      max-height: 80px;
    }

    .barcode-instructions {
      font-size: 0.8rem;
      color: #555;
      text-align: center;
    }

    .upload-barcode-btn {
      background-color: #4CAF50;
      color: white;
      border: none;
      padding: 5px 10px;
      border-radius: 5px;
      font-size: 0.8rem;
      margin-top: 10px;
      cursor: pointer;
    }

    .card-flip-back {
      font-size: 0.7rem;
      color: #777;
      text-align: center;
      margin-bottom: 5px;
    }

    .today-workout-preview {
      background-color: #f8f9fa;
      border-radius: 8px;
      padding: 15px;
      margin-top: 15px;
      border-left: 4px solid #4CAF50;
    }

    .today-workout-preview h3 {
      margin-top: 0;
      font-size: 1.1rem;
      color: #333;
    }

    .day-label {
      font-weight: 600;
      color: #4CAF50;
    }

    .workout-focus {
      color: #666;
      margin: 5px 0 15px 0;
      font-size: 0.9rem;
    }

    #view-today-workout {
      padding: 8px 15px;
      font-size: 0.9rem;
    }
  </style>
</head>
<body>
  <div id="app">

    <!-- Content Area -->
    <main class="content-area">
      <section class="hero-section">
        <div class="welcome-message">Good morning, Walter! Ready to crush today's workout?</div>
        <div class="motivation-quote">"The only bad workout is the one that didn't happen."</div>
        
        <div class="next-workout" id="todays-workout-container">
          <h3>Today's Workout</h3>
          <div id="workout-loading">Loading today's workout...</div>
        </div>
      </section>
      
      <section class="goal-tracker">
        <h3>Your Goal</h3>
        <div id="current-goal">Muscle Gain - 8 lbs</div>
        <div class="progress-bar">
          <div class="progress-fill"></div>
        </div>
        <div class="completion-time">Estimated completion: 6 weeks</div>
        <div class="action-buttons">
          <button class="action-btn">Adjust Goal</button>
          <button class="action-btn">Set New Goal</button>
        </div>
      </section>

      <!-- Gym Membership Card -->
      <div class="dashboard-card" style="margin-top: 20px;">
        <h3 style="color: #000; margin-top: 0;">Gym Membership</h3>
        
        <div class="card-container">
          <div class="membership-card" id="membership-card">
            <!-- Front of card -->
            <div class="card-side card-front">
              <div class="card-logo">
                <i class="fas fa-dumbbell"></i>
                <span>FITNESS CLUB</span>
              </div>
              <div class="card-details">
                <div class="member-name"><span id="user-name-card">Walter</span></div>
                <div class="member-id">ID: <span id="member-id">FC-1234567</span></div>
                <div class="member-since">Member since: <span id="member-since">Jan 2023</span></div>
                <div class="card-instructions">Tap card to show barcode</div>
              </div>
            </div>
            
            <!-- Back of card -->
            <div class="card-side card-back">
              <div class="barcode-container">
                <div id="barcode-placeholder">
                  <!-- Barcode will be displayed here -->
                  <img id="barcode-image" src="https://bwipjs-api.metafloor.com/?bcid=code128&text=FC1234567&scale=3&includetext=true" alt="Membership Barcode">
                </div>
                <div class="barcode-instructions">
                  <p>Show this barcode at the gym entrance</p>
                  <button class="upload-barcode-btn" id="upload-barcode-btn">
                    <i class="fas fa-upload"></i> Upload Your Barcode
                  </button>
                  <input type="file" id="barcode-input" accept="image/*" style="display: none;">
                </div>
              </div>
              <div class="card-flip-back">Tap to flip back</div>
            </div>
          </div>
        </div>
      </div>

      <section id="day-workout-section" class="app-section hidden-section">
        <h2 id="day-title">Workout Title</h2>
        <p id="workout-notes">Workout notes will appear here.</p>
        <table class="workout-table">
          <thead>
            <tr>
              <th>Week/Day</th>
            </tr>
          </thead>
          <tbody>
            <!-- Rows will be dynamically added here -->
          </tbody>
        </table>
        <button class="day-btn" data-day="Saturday" onclick="showDayWorkout('Saturday')">Saturday</button>
        <button class="day-btn" data-day="Friday" onclick="showDayWorkout('Friday')">Today's Workout</button>
      </section>
    </main>

    <!-- Bottom Navigation -->
    <script src="../../assets/js/navigation.js"></script>
    <script>
      // Insert navigation for adult user, with "home" active, for user "walter"
      insertNavigation('adult', 'home', 'walter');
    </script>
  </div>
  <!-- For walter.html -->
<script src="../../assets/js/navigation.js"></script>


  <script src="../../assets/js/fitness.js"></script>
  <script>
    function logout() {
      // Go back to the landing page
      window.location.href = '../../index.html';
    }

    // Setup the membership card
    document.addEventListener('DOMContentLoaded', function() {
      // Set up the membership card
      setupMembershipCard();
    });

    function setupMembershipCard() {
      // Get the current user
      const currentUser = localStorage.getItem('currentUser') || 'Walter';
      document.getElementById('user-name-card').textContent = currentUser;
      
      // Set membership ID (you could store this in localStorage too)
      const memberID = localStorage.getItem('memberID_' + currentUser) || 'FC-1234567';
      document.getElementById('member-id').textContent = memberID;
      
      // Set member since date
      const memberSince = localStorage.getItem('memberSince_' + currentUser) || 'Jan 2023';
      document.getElementById('member-since').textContent = memberSince;
      
      // Load custom barcode if exists
      const customBarcode = localStorage.getItem('barcodeImage_' + currentUser);
      if (customBarcode) {
        document.getElementById('barcode-image').src = customBarcode;
      } else {
        // Generate a barcode using bwipjs API (or you could use any barcode API)
        // This creates a Code 128 barcode with the member ID
        const barcodeText = memberID.replace(/\D/g, ''); // Remove non-digits
        document.getElementById('barcode-image').src = 
          `https://bwipjs-api.metafloor.com/?bcid=code128&text=${barcodeText}&scale=3&includetext=true`;
      }
      
      // Set up card flip
      const membershipCard = document.getElementById('membership-card');
      membershipCard.addEventListener('click', function() {
        this.classList.toggle('flipped');
      });
      
      // Set up barcode upload
      const uploadBtn = document.getElementById('upload-barcode-btn');
      const barcodeInput = document.getElementById('barcode-input');
      
      uploadBtn.addEventListener('click', function(e) {
        e.stopPropagation(); // Prevent card flip when clicking the button
        barcodeInput.click();
      });
      
      barcodeInput.addEventListener('change', function(event) {
        const file = event.target.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = function(e) {
            const imgData = e.target.result;
            document.getElementById('barcode-image').src = imgData;
            localStorage.setItem('barcodeImage_' + currentUser, imgData);
          };
          reader.readAsDataURL(file);
        }
      });
    }
    

    // Replace your current showTodaysWorkoutPreview function with this improved version

    function showTodaysWorkoutPreview() {
      // Get current day of week
      const today = new Date().toLocaleDateString('en-US', { weekday: 'long' });
      console.log('Current day:', today);
      
      // Reference to the container
      const workoutContainer = document.getElementById('todays-workout-container');
      
      // Check if Fitness.js data is available
      if (typeof weeklyWorkouts === 'undefined') {
        console.error('weeklyWorkouts not found. Fitness.js might not be loaded properly.');
        workoutContainer.innerHTML = `
          <h3>Today's Workout</h3>
          <div class="workout-error">
            <p>Couldn't load workout data. Please check your connection.</p>
            <button class="start-btn" onclick="window.location.href='../../workouts/index.html'">View All Workouts</button>
          </div>
        `;
        return;
      }
      
      // Find the workout for today
      const todaysWorkout = weeklyWorkouts[today];
      console.log('Today\'s workout:', todaysWorkout);
      
      if (todaysWorkout) {
        // We have a workout for today - show it
        workoutContainer.innerHTML = `
          <h3>Today's Workout: ${today}</h3>
          <div class="today-workout-preview">
            <h3><span class="day-label">${today}:</span> ${todaysWorkout.title}</h3>
            <p class="workout-focus">Focus: ${todaysWorkout.category || 'Full Body'}</p>
            <p class="workout-focus">Duration: ${todaysWorkout.duration || '45'} min</p>
            <button class="start-btn" onclick="window.location.href='../../workouts/index.html?day=${today}'">Start Workout</button>
          </div>
        `;
      } else {
        // No workout found for today
        workoutContainer.innerHTML = `
          <h3>Today's Workout: ${today}</h3>
          <div class="today-workout-preview">
            <h3><span class="day-label">Rest Day</span></h3>
            <p class="workout-focus">Take time to recover and prepare for your next workout!</p>
            <button class="start-btn" onclick="window.location.href='../../workouts/index.html'">View All Workouts</button>
          </div>
        `;
      }
    }

    // Make sure this function runs when the page is fully loaded
    document.addEventListener('DOMContentLoaded', function() {
      // First call setupMembershipCard
      setupMembershipCard();
      
      // Then call our workout function after a slight delay to ensure Fitness.js is loaded
      setTimeout(showTodaysWorkoutPreview, 300);
    });
  </script>
</body>
</html>